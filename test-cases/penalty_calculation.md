# Тест-кейсы: расчёт пени по ст. 112 229-ФЗ

> Формула: `Пеня = Сумма_долга × 7% / 365 × Дней_просрочки`

## Базовые сценарии

| ID | Сумма долга | Дней просрочки | Ожидаемая пеня | Формула | Приоритет |
|----|-------------|----------------|----------------|---------|-----------|
| PEN-01 | 10 000 ₽ | 0 | 0.00 ₽ | `10000 × 0.07 / 365 × 0` | Критичный |
| PEN-02 | 10 000 ₽ | 1 | 1.92 ₽ | `10000 × 0.07 / 365 × 1` | Критичный |
| PEN-03 | 10 000 ₽ | 30 | 57.53 ₽ | `10000 × 0.07 / 365 × 30` | Критичный |
| PEN-04 | 10 000 ₽ | 365 | 700.00 ₽ | `10000 × 0.07 / 365 × 365` | Критичный |
| PEN-05 | 100 000 ₽ | 30 | 575.34 ₽ | `100000 × 0.07 / 365 × 30` | Высокий |

## Граничные значения

| ID | Сумма долга | Дней просрочки | Ожидаемая пеня | Приоритет | Комментарий |
|----|-------------|----------------|----------------|-----------|-------------|
| PEN-06 | 1 ₽ | 1 | 0.00 ₽ | Высокий | Округление до копеек |
| PEN-07 | 1 ₽ | 365 | 0.07 ₽ | Высокий | Минимальная пеня |
| PEN-08 | 999 999 ₽ | 365 | 69 999.93 ₽ | Высокий | Максимальная сумма |
| PEN-09 | 10 000 ₽ | 366 | 701.92 ₽ | Средний | Больше года просрочки |

## Ошибки реализации (что проверять!)

| Сценарий | Частая ошибка | Как проверить |
|----------|---------------|---------------|
| Расчёт пени | Использование 360 вместо 365 в формуле | Сравнить результат с калькулятором: `10000 × 0.07 / 365 × 30 = 57.53` |
| Округление | Округление до целых рублей | Проверить копейки: пеня за 1 день от 10 000 ₽ = 1.92 ₽, не 2 ₽ |
| Дата окончания | Включать/исключать дату окончания срока | Проверить: если срок до 01.01, то 02.01 = 1 день просрочки |
| Праздничные дни | Учитывать/не учитывать выходные | Согласно 229-ФЗ: **все дни подряд**, выходные не исключаются |

## Тест через SQL (валидация в БД)

```sql
-- Проверка расчёта пени для ИП-2025-12345
SELECT 
  debt_sum AS "Сумма долга",
  days_overdue AS "Дней просрочки",
  penalty AS "Рассчитанная пеня",
  ROUND(debt_sum * 0.07 / 365 * days_overdue, 2) AS "Ожидаемая пеня"
FROM executions 
WHERE id = 'IP-2025-12345';
